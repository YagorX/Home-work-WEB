<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ç–∞–ª–æ–≥ Renault</title>
    <link rel="stylesheet" href="styles/style2.css">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ */

                .user-header {
            margin-right: 15px;
            font-size: 14px;
            color: #333;
        }

        .user-name {
            cursor: pointer;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 20px;
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .user-name:hover {
            background: #0078D7;
            color: #fff;
            border-color: #0078D7;
        }

        .search-container {
            max-width: 1200px;
            margin: 20px auto 30px;
            padding: 0 20px;
            display: flex;
            justify-content: center;
        }

        .input-container {
            display: flex;
            gap: 10px;
            align-items: center;
            max-width: 400px;
            width: 100%;
        }

        .search-input {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #333;
            font-size: 14px;
            width: 100%;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #0078D7;
            box-shadow: 0 0 0 2px rgba(0, 120, 215, 0.2);
        }

        .search-output {
            background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: transform 0.3s ease;
            font-size: 14px;
            white-space: nowrap;
        }

        .search-output:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 0, 0, 0.3);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π */
        .category-filter {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 40px;
            flex-wrap: wrap;
            padding: 0 20px;
        }

        .category-btn {
            padding: 8px 16px;
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            color: #333;
        }

        .category-btn:hover {
            background: #e0e0e0;
            transform: translateY(-1px);
        }

        .category-btn.active {
            background: #0078D7;
            color: white;
            border-color: #0078D7;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–∏—Å–∫–µ */
        .search-info {
            text-align: center;
            margin: 15px auto;
            color: #666;
            font-size: 14px;
            max-width: 1200px;
            padding: 0 20px;
        }

        .search-stats {
            display: inline-block;
            padding: 5px 15px;
            background: #f8f9fa;
            border-radius: 20px;
            border: 1px solid #e9ecef;
        }

        .clear-search {
            margin-left: 10px;
            padding: 5px 12px;
            background: #f8f9fa;
            border: 1px solid #dc3545;
            border-radius: 20px;
            color: #dc3545;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s ease;
        }

        .clear-search:hover {
            background: #dc3545;
            color: white;
        }

        .clear-search.hidden {
            display: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .highlight {
            background-color: #ffeb3b;
            padding: 1px 3px;
            border-radius: 3px;
            font-weight: bold;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—É—Å—Ç—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
        .no-results {
            text-align: center;
            padding: 50px 20px;
            color: #666;
            display: none;
            max-width: 600px;
            margin: 0 auto;
            background: #f8f9fa;
            border-radius: 10px;
            margin-top: 30px;
        }

        .no-results.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .no-results h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .no-results p {
            color: #777;
            margin-bottom: 20px;
        }

        .try-again-btn {
            padding: 8px 20px;
            background: #0078D7;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .try-again-btn:hover {
            background: #0056A6;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è/–ø–æ–∫–∞–∑–∞ */
        .section.hidden {
            display: none;
        }

        .card.hidden {
            display: none;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ */
        .card:not(.hidden) {
            animation: fadeIn 0.5s ease;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É */
        .cart-btn {
            background: linear-gradient(135deg, #28a745 0%, #218838 100%);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 16px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .cart-btn.added {
            background: linear-gradient(135deg, #6c757d 0%, #545b62 100%);
        }

        .cart-btn.added:hover {
            transform: none;
            box-shadow: none;
        }

        .cart-btn .cart-icon {
            font-size: 16px;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–∫–æ–Ω–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã –≤ —à–∞–ø–∫–µ */
        .cart-header {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cart-icon-header {
            position: relative;
            cursor: pointer;
            font-size: 24px;
            color: #333;
            transition: color 0.3s ease;
        }

        .cart-icon-header:hover {
            color: #0078D7;
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff0000;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–æ—Ä–∑–∏–Ω—ã */
        .cart-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .cart-modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .cart-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #666;
            transition: color 0.3s ease;
        }

        .cart-close:hover {
            color: #333;
        }

        .cart-title {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .cart-items {
            margin-bottom: 30px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 10px;
            background: #f8f9fa;
            transition: transform 0.3s ease;
        }

        .cart-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .cart-item-image {
            width: 100px;
            height: 70px;
            object-fit: cover;
            border-radius: 5px;
            margin-right: 20px;
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: #ff0000;
            font-weight: bold;
            font-size: 18px;
        }

        .remove-item {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 16px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .remove-item:hover {
            background: #c82333;
        }

        .cart-empty {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .cart-empty h3 {
            margin-bottom: 10px;
        }

        .cart-total {
            text-align: right;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .total-label {
            font-size: 18px;
            color: #333;
            margin-right: 10px;
        }

        .total-price {
            font-size: 24px;
            color: #ff0000;
            font-weight: bold;
        }

        .cart-actions {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .clear-cart-btn {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
            flex: 1;
        }

        .clear-cart-btn:hover {
            background: #545b62;
        }

        .checkout-btn {
            background: linear-gradient(135deg, #28a745 0%, #218838 100%);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 12px 24px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
            flex: 2;
        }

        .checkout-btn:hover {
            background: linear-gradient(135deg, #218838 0%, #1e7e34 100%);
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: none;
            z-index: 1001;
            animation: slideIn 0.3s ease;
        }

        .notification.show {
            display: block;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .search-container {
                padding: 0 15px;
            }

            .input-container {
                flex-direction: column;
                gap: 10px;
            }

            .search-input, .search-output {
                width: 100%;
                text-align: center;
            }

            .category-filter {
                gap: 8px;
            }

            .category-btn {
                padding: 6px 12px;
                font-size: 13px;
            }

            .search-info {
                font-size: 13px;
            }

            .cart-header {
                top: 15px;
                right: 15px;
            }

            .cart-modal-content {
                margin: 10% auto;
                padding: 20px;
                width: 95%;
            }

            .cart-item {
                flex-direction: column;
                text-align: center;
            }

            .cart-item-image {
                margin-right: 0;
                margin-bottom: 10px;
            }

            .cart-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .search-container {
                margin: 15px auto;
            }

            .category-filter {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 10px;
            }

            .category-btn {
                flex-shrink: 0;
            }

            .home-button-container {
                margin-top: 50px;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .gallery-modal {
            display: none;
            position: fixed;
            z-index: 1100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }

        .gallery-content {
            position: relative;
            margin: 3% auto;
            max-width: 900px;
            width: 90%;
            text-align: center;
        }

        .gallery-image {
            max-width: 100%;
            max-height: 80vh;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .gallery-close {
            position: absolute;
            top: -10px;
            right: 0;
            font-size: 32px;
            color: #fff;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .gallery-close:hover {
            color: #ff0000;
        }

        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            border: none;
            color: #fff;
            font-size: 30px;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 50%;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .gallery-nav.prev {
            left: 10px;
        }

        .gallery-nav.next {
            right: 10px;
        }

        .gallery-nav:hover {
            background: rgba(0,0,0,0.8);
            transform: translateY(-50%) scale(1.05);
        }

        .gallery-counter {
            margin-top: 10px;
            color: #fff;
            font-size: 14px;
            text-shadow: 0 0 5px rgba(0,0,0,0.7);
        }

        @media (max-width: 768px) {
            .gallery-content {
                width: 95%;
            }
            .gallery-nav {
                font-size: 24px;
                padding: 8px 12px;
            }
        }

        .cart-item-quantity {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 8px;
}

    .quantity-btn {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        border: 1px solid #ccc;
        background: #fff;
        font-size: 18px;
        line-height: 1;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .quantity-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .quantity-value {
        min-width: 24px;
        text-align: center;
        font-weight: bold;
    }

    /* –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è –≥–æ—Å—Ç–µ–π */
    .disabled-cart {
        background: #6c757d;
        opacity: 0.9;
    }

    </style>
</head>
<body>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Ä–∞–∑–º—ã—Ç—ã–º —Ñ–æ–Ω–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π -->
    <div class="home-button-container">
        <a href="index.html" class="home-button">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a>

        <div class="search-container">
            <div class="input-container">
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput" 
                    placeholder="–ü–æ–∏—Å–∫ –ø–æ –∫–∞—Ç–∞–ª–æ–≥—É: –º–æ–¥–µ–ª—å, –æ–ø–∏—Å–∞–Ω–∏–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏..."
                    autocomplete="off"
                >
                <input 
                    type="button" 
                    class="search-output" 
                    id="searchButton" 
                    value="–ò—Å–∫–∞—Ç—å"
                >
            </div>
        </div>

        <!-- –ò–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
        <div class="cart-header">
            <div class="cart-icon-header" id="cartIcon">
                üõí
                <span class="cart-count" id="cartCount">0</span>
            </div>
        </div>

        <!-- <div class="cart-header">
            <div class="user-header">
                <span id="userNameLink" class="user-name"></span>
            </div>
            <div class="cart-icon-header" id="cartIcon">
                üõí
                <span class="cart-count" id="cartCount">0</span>
            </div> -->

    </div>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–∏—Å–∫–µ -->
    <div class="search-info">
        <div class="search-stats">
            –í—Å–µ–≥–æ: <span id="totalCount">0</span> | –ù–∞–π–¥–µ–Ω–æ: <span id="foundCount">0</span>
            <button class="clear-search hidden" id="clearSearch">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º -->
    <div class="category-filter" id="categoryFilter">
        <button class="category-btn active" data-category="all">–í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</button>
        <button class="category-btn" data-category="light-cars">–õ–µ–≥–∫–æ–≤—ã–µ</button>
        <button class="category-btn" data-category="crossovers">–ö—Ä–æ—Å—Å–æ–≤–µ—Ä—ã</button>
        <button class="category-btn" data-category="commercial">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ</button>
        <button class="category-btn" data-category="electro">–≠–ª–µ–∫—Ç—Ä–æ/–≥–∏–±—Ä–∏–¥—ã</button>
    </div>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
    <div class="no-results" id="noResults">
        <h3>üöó –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
        <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</p>
        <button class="try-again-btn" id="tryAgainBtn">–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã -->
    <div id="cartModal" class="cart-modal">
        <div class="cart-modal-content">
            <span class="cart-close">&times;</span>
            <h2 class="cart-title">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>

            <div class="cart-items" id="cartItems">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
            </div>

            <div class="cart-empty" id="cartEmpty">
                <h3>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</h3>
                <p>–î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞</p>
            </div>

            <div class="cart-total" id="cartTotal">
                <span class="total-label">–ò—Ç–æ–≥–æ:</span>
                <span class="total-price" id="totalPrice">0 ‚ÇΩ</span>
            </div>

            <div class="cart-actions">
                <button class="clear-cart-btn" id="clearCartBtn">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="checkout-btn" id="checkoutBtn">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞—è–≤–∫—É</button>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification">
        –ê–≤—Ç–æ–º–æ–±–∏–ª—å –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
    <div id="carModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div class="modal-header">
                <img class="modal-image" id="modalImage" src="" alt="–ê–≤—Ç–æ–º–æ–±–∏–ª—å">
                <div class="modal-title">
                    <h2 id="modalCarTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏</h2>
                    <div class="modal-price" id="modalPrice">–æ—Ç 0 ‚ÇΩ</div>
                </div>
            </div>
            
            <div class="modal-description" id="modalDescription">
                –û–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è...
            </div>
            
            <div class="modal-specs">
                <div class="spec-group">
                    <h3>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
                    <ul class="spec-list" id="techSpecs"></ul>
                </div>
                
                <div class="spec-group">
                    <h3>–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è</h3>
                    <ul class="spec-list" id="equipmentSpecs"></ul>
                </div>
            </div>
            
            <div class="modal-features">
                <h3>–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</h3>
                <div class="features-grid" id="featuresGrid"></div>
            </div>
            
            <div class="modal-actions">
                <button class="test-drive-btn">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤</button>
                <button class="contact-btn">–°–≤—è–∑–∞—Ç—å—Å—è —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≥–∞–ª–µ—Ä–µ–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
    <div id="imageGalleryModal" class="gallery-modal">
        <div class="gallery-content">
            <span class="gallery-close">&times;</span>
            <button class="gallery-nav prev">&#10094;</button>
            <img id="galleryImage" class="gallery-image" src="" alt="–§–æ—Ç–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è">
            <button class="gallery-nav next">&#10095;</button>
            <div id="galleryCounter" class="gallery-counter">1 / 1</div>
        </div>
    </div>

    </div>

    <div class="catalog-container">
        <h1 class="catalog-title">–ö–∞—Ç–∞–ª–æ–≥ Renault</h1>

        <!-- –†–∞–∑–¥–µ–ª 1: –õ–µ–≥–∫–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ -->
        <div class="section" id="light-cars">
            <h2 class="section-title">–õ–µ–≥–∫–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h2>
            <div class="cards-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª 2: –ö—Ä–æ—Å—Å–æ–≤–µ—Ä—ã -->
        <div class="section" id="crossovers">
            <h2 class="section-title">–ö—Ä–æ—Å—Å–æ–≤–µ—Ä—ã</h2>
            <div class="cards-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª 3: –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ -->
        <div class="section" id="commercial">
            <h2 class="section-title">–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h2>
            <div class="cards-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –†–∞–∑–¥–µ–ª 4: –≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ –∏ –≥–∏–±—Ä–∏–¥—ã -->
        <div class="section" id="electro">
            <h2 class="section-title">–≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏ –∏ –≥–∏–±—Ä–∏–¥—ã</h2>
            <div class="cards-grid">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç —Ç—ã –ø–æ–¥–∫–ª—é—á–∞–µ—à—å —Å–∞–º -->
</body>
</html>

<script>
//     // ------------- –ö–û–†–ó–ò–ù–ê -------------
//     // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª—é—á –¥–ª—è –∫–æ—Ä–∑–∏–Ω—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function getCartStorageKey() {
    const userId = localStorage.getItem('currentUserId');
    // –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚Äì –∫–ª—é—á–∞ –Ω–µ—Ç
    return userId ? `cart_${userId}` : null;
    }

    // –ö–ª—é—á –∏ —Ñ–ª–∞–≥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
    const CART_STORAGE_KEY = getCartStorageKey();
    const isLoggedIn = !!CART_STORAGE_KEY;

    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    let cart = [];
    if (isLoggedIn) {
        cart = JSON.parse(localStorage.getItem(CART_STORAGE_KEY)) || [];
    }

    const cartModal = document.getElementById('cartModal');
    const cartIcon = document.getElementById('cartIcon');
    const cartCount = document.getElementById('cartCount');
    const cartItemsContainer = document.getElementById('cartItems');
    const cartEmpty = document.getElementById('cartEmpty');
    const cartTotal = document.getElementById('cartTotal');
    const totalPriceEl = document.getElementById('totalPrice');
    const clearCartBtn = document.getElementById('clearCartBtn');
    const checkoutBtn = document.getElementById('checkoutBtn');
    const notification = document.getElementById('notification');
    const cartCloseBtn = document.querySelector('.cart-close');
    const API_BASE = 'http://localhost:8080';

//     // ----- –ì–ê–õ–ï–†–ï–Ø –§–û–¢–û -----
    let currentCarId = null;
    let currentGallery = [];
    let currentGalleryIndex = 0;

    const imageGalleryModal = document.getElementById('imageGalleryModal');
    const galleryImage = document.getElementById('galleryImage');
    const galleryClose = document.querySelector('.gallery-close');
    const galleryPrev = document.querySelector('.gallery-nav.prev');
    const galleryNext = document.querySelector('.gallery-nav.next');
    const galleryCounter = document.getElementById('galleryCounter');

    function initCart() {
        updateCartCount();
        renderCart();
        setupCartEventListeners();
    }

    function setupCartEventListeners() {
        cartIcon.addEventListener('click', openCart);
        cartCloseBtn.addEventListener('click', closeCart);
        clearCartBtn.addEventListener('click', clearCart);
        checkoutBtn.addEventListener('click', checkout);

        window.addEventListener('click', (e) => {
            if (e.target === cartModal) {
                closeCart();
            }
        });
    }

    function addToCart(button) {
        // –ì–æ—Å—Ç—å –Ω–µ –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
        if (!isLoggedIn) {
            alert('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
            return;
        }

        const id = button.dataset.id;
        const title = button.dataset.title;
        const price = parseInt(button.dataset.price);
        const image = button.dataset.image;

        const existingItem = cart.find(item => item.id === id);

        if (existingItem) {
            existingItem.quantity++;
        } else {
            cart.push({
                id, title, price, image, quantity: 1
            });
        }

        saveCart();
        updateCartCount();
        renderCart();
        showNotification(`${title} –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!`);
        updateButtonState(button, true);
}





    function updateButtonState(button, added) {
        if (added) {
            button.classList.add('added');
            button.innerHTML = '<span class="cart-icon">‚úì</span> –í –∫–æ—Ä–∑–∏–Ω–µ';
            button.onclick = null;
            button.style.cursor = 'default';

            setTimeout(() => {
                button.classList.remove('added');
                button.innerHTML = '<span class="cart-icon">üõí</span> –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É';
                button.onclick = function() { addToCart(this); };
                button.style.cursor = 'pointer';
            }, 3000);
        }
    }

    function removeFromCart(id) {
        cart = cart.filter(item => item.id !== id);
        saveCart();
        updateCartCount();
        renderCart();
        updateCartButtons();
    }

// –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ç–∞–ª–æ–≥–∞
async function loadCartFromServer() {
    // –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Äì –∫–æ—Ä–∑–∏–Ω—É –Ω–µ –≥—Ä—É–∑–∏–º
    if (!isLoggedIn) {
        cart = [];
        updateCartCount();
        updateCartButtons();
        return;
    }

    try {
        const res = await fetch(`${API_BASE}/api/cart`, {
            headers: {
                'X-User-Id': currentUserId
            }
        });

        if (!res.ok) {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã:', res.status);
            cart = [];
            updateCartCount();
            updateCartButtons();
            return;
        }

        const data = await res.json();
        cart = Array.isArray(data) ? data : [];

        // –û–∂–∏–¥–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ—Ä–∑–∏–Ω—ã:
        // {
        //   id: number/—Å—Ç—Ä–æ–∫–∞  ‚Äì id –∑–∞–ø–∏—Å–∏ –∫–æ—Ä–∑–∏–Ω—ã
        //   carId: string      ‚Äì id –∞–≤—Ç–æ–º–æ–±–∏–ª—è
        //   title: string
        //   price: number
        //   image: string
        //   quantity: number
        // }

        renderCart();       // –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –º–æ–¥–∞–ª–∫—É (–µ—Å–ª–∏ –µ—ë –æ—Ç–∫—Ä–æ—é—Ç)
        updateCartCount();  // –æ–±–Ω–æ–≤–∏—Ç—å —Å—á—ë—Ç—á–∏–∫ –≤ —à–∞–ø–∫–µ
        updateCartButtons();// –ø–æ–¥—Å–≤–µ—Ç–∏—Ç—å –∫–Ω–æ–ø–∫–∏ "–í –∫–æ—Ä–∑–∏–Ω–µ"
    } catch (e) {
        console.error('loadCartFromServer error:', e);
        cart = [];
        updateCartCount();
        updateCartButtons();
    }
}


    function clearCart() {
        if (cart.length === 0) return;
        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) {
            cart = [];
            saveCart();
            updateCartCount();
            renderCart();
            updateCartButtons();
            showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –æ—á–∏—â–µ–Ω–∞');
        }
    }

    function checkout() {
        if (cart.length === 0) {
            alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞! –î–æ–±–∞–≤—å—Ç–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.');
            return;
        }

        let message = '–ó–∞—è–≤–∫–∞ –Ω–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏:\n\n';
        cart.forEach(item => {
            message += `${item.title} - ${formatPrice(item.price)} (${item.quantity} —à—Ç.)\n`;
        });

        const total = calculateTotal();
        message += `\n–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${formatPrice(total)}`;
        message += '\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–≤—è–∑–∏:';

        const name = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:');
        if (!name) return;

        const phone = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:');
        if (!phone) return;

        const email = prompt('–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email:');

        message += `\n\n–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\n–ò–º—è: ${name}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${phone}`;
        if (email) message += `\nEmail: ${email}`;

        console.log('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞:', message);

        alert(`–°–ø–∞—Å–∏–±–æ –∑–∞ –∑–∞—è–≤–∫—É, ${name}! –ù–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É ${phone}.`);

        cart = [];
        saveCart();
        updateCartCount();
        renderCart();
        updateCartButtons();
        closeCart();
    }

    function saveCart() {
    // –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Äì –Ω–∏—á–µ–≥–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
    if (!CART_STORAGE_KEY) return;
    localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
}

    function updateCartCount() {
        if (!isLoggedIn) {
            // –¥–ª—è –≥–æ—Å—Ç—è –ø—Ä–æ—Å—Ç–æ —Å–∫—Ä—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
            cartCount.style.display = 'none';
            cartCount.textContent = '0';
            return;
        }

        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;

        if (totalItems > 0) {
            cartCount.style.display = 'flex';
        } else {
            cartCount.style.display = 'none';
        }
}


    function renderCart() {
        cartItemsContainer.innerHTML = '';

        if (cart.length === 0) {
            cartEmpty.style.display = 'block';
            cartTotal.style.display = 'none';
            return;
        }

        cartEmpty.style.display = 'none';
        cartTotal.style.display = 'block';

        cart.forEach(item => {
            const cartItem = document.createElement('div');
            cartItem.className = 'cart-item';
            cartItem.innerHTML = `
                <img src="${item.image}" alt="${item.title}" class="cart-item-image">
                <div class="cart-item-info">
                    <div class="cart-item-title">${item.title}</div>
                    <div class="cart-item-price">${formatPrice(item.price)}</div>
                    <div class="cart-item-quantity">
                        <button class="quantity-btn" onclick="changeQuantity('${item.id}', -1)">‚àí</button>
                        <span class="quantity-value">${item.quantity}</span>
                        <button class="quantity-btn" onclick="changeQuantity('${item.id}', 1)">+</button>
                    </div>
                </div>
                <button class="remove-item" onclick="removeFromCart('${item.id}')">–£–¥–∞–ª–∏—Ç—å</button>
            `;
            cartItemsContainer.appendChild(cartItem);
        });

        const total = calculateTotal();
        totalPriceEl.textContent = `${formatPrice(total)}`;
    }

    function changeQuantity(id, delta) {
        const item = cart.find(i => i.id === id);
        if (!item) return;

        item.quantity += delta;

        // –µ—Å–ª–∏ —Å—Ç–∞–ª–æ 0 –∏–ª–∏ –º–µ–Ω—å—à–µ ‚Äì —Å–ø—Ä–∞—à–∏–≤–∞–µ–º, —É–¥–∞–ª–∏—Ç—å –ª–∏ —Ç–æ–≤–∞—Ä
        if (item.quantity <= 0) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã?')) {
                removeFromCart(id);
                return;
            } else {
                item.quantity = 1;
            }
        }

        saveCart();
        updateCartCount();
        renderCart();
        updateCartButtons();
    }

    function updateCartButtons() {
        const buttons = document.querySelectorAll('.cart-btn');

        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω ‚Äì –±–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã
        if (!isLoggedIn) {
            buttons.forEach(button => {
                button.classList.add('disabled-cart');
                button.innerHTML = '<span class="cart-icon">üîí</span> –í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å';
                button.onclick = function () {
                    alert('–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ—Ä–∑–∏–Ω—É –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
                };
                button.style.cursor = 'pointer';
            });
            return;
        }

        // –î–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äì –æ–±—ã—á–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
        buttons.forEach(button => {
            const id = button.dataset.id;
            const inCart = cart.some(item => item.id === id);

            if (inCart) {
                button.classList.add('added');
                button.innerHTML = '<span class="cart-icon">‚úì</span> –í –∫–æ—Ä–∑–∏–Ω–µ';
                button.onclick = null;
                button.style.cursor = 'default';
            } else {
                button.classList.remove('added');
                button.innerHTML = '<span class="cart-icon">üõí</span> –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É';
                button.onclick = function() { addToCart(this); };
                button.style.cursor = 'pointer';
            }
        });
}


    function calculateTotal() {
        return cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    }

    function formatPrice(price) {
        return new Intl.NumberFormat('ru-RU', {
            style: 'currency',
            currency: 'RUB',
            minimumFractionDigits: 0
        }).format(price);
    }

    function showNotification(message) {
        notification.textContent = message;
        notification.classList.add('show');

        setTimeout(() => {
            notification.classList.remove('show');
        }, 3000);
    }

    function openCart() {
        if (!isLoggedIn) {
            alert('–ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ—Ä–∑–∏–Ω—ã –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
            return;
        }
        cartModal.style.display = 'block';
        renderCart();
}


    function closeCart() {
        cartModal.style.display = 'none';
    }


    // ------------- –ü–û–ò–°–ö + –§–ò–õ–¨–¢–† -------------

    const searchInput = document.getElementById('searchInput');
    const searchButton = document.getElementById('searchButton');
    const clearSearch = document.getElementById('clearSearch');
    const tryAgainBtn = document.getElementById('tryAgainBtn');
    const noResults = document.getElementById('noResults');
    const categoryFilter = document.getElementById('categoryFilter');
    const categoryBtns = document.querySelectorAll('.category-btn');
    const totalCountEl = document.getElementById('totalCount');
    const foundCountEl = document.getElementById('foundCount');

    let cards = []; // —Ç–µ–ø–µ—Ä—å –º—ã –∑–∞–ø–æ–ª–Ω—è–µ–º —ç—Ç–æ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Å API
    const sections = document.querySelectorAll('.section');

    let activeCategory = 'all';
    let lastSearchTerm = '';

    function initSearch() {
        cards = Array.from(document.querySelectorAll('.card'));
        totalCountEl.textContent = cards.length;
        updateSearchStats();

        searchButton.addEventListener('click', performSearch);

        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        clearSearch.addEventListener('click', function() {
            searchInput.value = '';
            lastSearchTerm = '';
            setActiveCategory('all');
            performSearch();
            this.classList.add('hidden');
        });

        tryAgainBtn.addEventListener('click', function() {
            searchInput.value = '';
            lastSearchTerm = '';
            setActiveCategory('all');
            performSearch();
            searchInput.focus();
        });

        categoryBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const category = this.dataset.category;
                setActiveCategory(category);
                performSearch();
            });
        });

        let searchTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                if (this.value.trim() !== lastSearchTerm) {
                    performSearch();
                }
            }, 300);
        });
    }

    function initCategoryFromUrl() {
    const params = new URLSearchParams(window.location.search);
    const categoryFromUrl = params.get('category');
    const searchFromUrl   = params.get('q');

    // –ï—Å–ª–∏ –∏–∑ –∞–¥—Ä–µ—Å–∞ –ø–µ—Ä–µ–¥–∞–ª–∏ —Å—Ç—Ä–æ–∫—É –ø–æ–∏—Å–∫–∞ ‚Äì –ø–æ–¥—Å—Ç–∞–≤–∏–º –µ—ë –≤ input
    if (searchFromUrl && typeof searchInput !== 'undefined' && searchInput) {
        searchInput.value = searchFromUrl;
    }

    // –ï—Å–ª–∏ –∏–∑ –∞–¥—Ä–µ—Å–∞ –ø–µ—Ä–µ–¥–∞–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é ‚Äì –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –µ—ë
    if (categoryFromUrl) {
        const btn = Array.from(document.querySelectorAll('.category-btn'))
            .find(b => b.dataset.category === categoryFromUrl);

        if (btn) {
            setActiveCategory(categoryFromUrl);
        }
    }

    // –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–µ–ª–∞–µ–º –ø–æ–∏—Å–∫
    performSearch();

    // –ï—Å–ª–∏ –µ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—è ‚Äì —Å–∫—Ä–æ–ª–ª–∏–º –∫ –Ω—É–∂–Ω–æ–º—É —Ä–∞–∑–¥–µ–ª—É
    if (categoryFromUrl) {
        const section = document.getElementById(categoryFromUrl);
        if (section) {
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
}

    function setActiveCategory(category) {
        activeCategory = category;
        categoryBtns.forEach(btn => {
            btn.classList.remove('active');
            if (btn.dataset.category === category) {
                btn.classList.add('active');
            }
        });
    }

    function performSearch() {
        const searchTerm = searchInput.value.toLowerCase().trim();
        lastSearchTerm = searchTerm;
        let foundCount = 0;

        noResults.classList.remove('show');

        if (searchTerm || activeCategory !== 'all') {
            clearSearch.classList.remove('hidden');
        } else {
            clearSearch.classList.add('hidden');
        }

        cards.forEach(card => {
            card.classList.remove('hidden');
            const title = card.querySelector('.card-title');
            const description = card.querySelector('.card-description');
            if (title) title.innerHTML = title.textContent;
            if (description) description.innerHTML = description.textContent;
        });
        sections.forEach(section => section.classList.remove('hidden'));

        if (searchTerm || activeCategory !== 'all') {
            cards.forEach(card => {
                const cardData = JSON.parse(card.dataset.searchIndex || '{}');
                const shouldShow = isCardMatch(cardData, searchTerm, activeCategory);

                if (shouldShow) {
                    card.classList.remove('hidden');
                    foundCount++;
                    if (searchTerm) {
                        highlightMatches(card, cardData, searchTerm);
                    }
                } else {
                    card.classList.add('hidden');
                }
            });

            sections.forEach(section => {
                const sectionCards = section.querySelectorAll('.card:not(.hidden)');
                if (sectionCards.length === 0) {
                    section.classList.add('hidden');
                } else {
                    section.classList.remove('hidden');
                }
            });

            if (foundCount === 0) {
                noResults.classList.add('show');
            }
        } else {
            cards.forEach(card => {
                card.classList.remove('hidden');
                foundCount++;
            });
        }

        updateSearchStats(foundCount);

        if (searchTerm && foundCount > 0) {
            const firstVisibleCard = document.querySelector('.card:not(.hidden)');
            if (firstVisibleCard) {
                firstVisibleCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }
        }
    }

    function isCardMatch(cardData, searchTerm, category) {
        if (category !== 'all') {
            const categoryMap = {
                'light-cars': '–õ–µ–≥–∫–æ–≤—ã–µ',
                'crossovers': '–ö—Ä–æ—Å—Å–æ–≤–µ—Ä—ã',
                'commercial': '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ',
                'electro': ['–≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏', '–ì–∏–±—Ä–∏–¥—ã']
            };

            const targetCategory = categoryMap[category];
            const cardCategory = cardData.category || '';

            if (Array.isArray(targetCategory)) {
                if (!targetCategory.includes(cardCategory)) {
                    return false;
                }
            } else if (cardCategory !== targetCategory) {
                return false;
            }
        }

        if (!searchTerm) return true;

        const searchFields = [
            cardData.title || '',
            cardData.description || '',
            cardData.price || '',
            ...(cardData.features || [])
        ];

        const searchText = searchFields.join(' ').toLowerCase();
        const terms = searchTerm.split(' ').filter(term => term.length > 0);

        return terms.every(term => searchText.includes(term));
    }

    function highlightMatches(card, cardData, searchTerm) {
        const terms = searchTerm.split(' ').filter(term => term.length > 0);
        const elementsToHighlight = [
            { element: card.querySelector('.card-title'), text: cardData.title || '' },
            { element: card.querySelector('.card-description'), text: cardData.description || '' }
        ];

        elementsToHighlight.forEach(item => {
            if (item.element && item.text) {
                let highlightedText = item.text;
                terms.forEach(term => {
                    const regex = new RegExp(`(${escapeRegExp(term)})`, 'gi');
                    highlightedText = highlightedText.replace(regex, '<span class="highlight">$1</span>');
                });
                item.element.innerHTML = highlightedText;
            }
        });
    }

    function escapeRegExp(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    function updateSearchStats(foundCount = null) {
        const totalCount = cards.length;
        foundCount = foundCount !== null ? foundCount : totalCount;

        totalCountEl.textContent = totalCount;
        foundCountEl.textContent = foundCount;

        if (foundCount === totalCount) {
            foundCountEl.style.color = '';
        } else if (foundCount > 0) {
            foundCountEl.style.color = '#28a745';
        } else {
            foundCountEl.style.color = '#dc3545';
        }
    }

    function openCurrentCarGallery(startIndex = 0) {
        if (!currentGallery || currentGallery.length === 0) return;
        showGalleryImage(startIndex);
        imageGalleryModal.style.display = 'block';
    }

    function showGalleryImage(index) {
        if (!currentGallery || currentGallery.length === 0) return;

        if (index < 0) index = currentGallery.length - 1;
        if (index >= currentGallery.length) index = 0;

        currentGalleryIndex = index;
        galleryImage.src = currentGallery[currentGalleryIndex];
        galleryCounter.textContent = `${currentGalleryIndex + 1} / ${currentGallery.length}`;
    }

    galleryPrev.addEventListener('click', function() {
        showGalleryImage(currentGalleryIndex - 1);
    });

    galleryNext.addEventListener('click', function() {
        showGalleryImage(currentGalleryIndex + 1);
    });

    galleryClose.addEventListener('click', function() {
        imageGalleryModal.style.display = 'none';
    });

    window.addEventListener('click', function(event) {
        if (event.target === imageGalleryModal) {
            imageGalleryModal.style.display = 'none';
        }
    });

    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            imageGalleryModal.style.display = 'none';
        }
    });

    // ------------- –ú–û–î–ê–õ–ö–ê –ê–í–¢–û -------------

    const carModal = document.getElementById('carModal');
    const closeBtn = document.querySelector('.close');

     async function showCarDetails(carId) {
        try {
            const response = await fetch(`${API_BASE}/api/cars/${carId}`);
            if (!response.ok) {
                if (response.status === 404) {
                    alert('–ê–≤—Ç–æ–º–æ–±–∏–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö');
                } else {
                    throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status}`);
                }
                return;
            }

            const car = await response.json();

            document.getElementById('modalCarTitle').textContent = car.title || car.model;
            document.getElementById('modalPrice').textContent = `–æ—Ç ${formatPrice(car.price)}`;
            const modalImage = document.getElementById('modalImage');
            modalImage.src = car.image;
            modalImage.alt = car.title || car.model;
            document.getElementById('modalDescription').textContent = car.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';

            // ----- –ù–ê–°–¢–†–û–ô–ö–ê –ì–ê–õ–ï–†–ï–ò -----
            currentCarId = car.id || carId;

            if (car.images && car.images.length > 0) {
                currentGallery = car.images;
            } else if (car.image) {
                currentGallery = [car.image];
            } else {
                currentGallery = [];
            }
            currentGalleryIndex = 0;

            // –∫–ª–∏–∫ –ø–æ —Ñ–æ—Ç–∫–µ –≤ –º–æ–¥–∞–ª–∫–µ ‚Äì –æ—Ç–∫—Ä—ã–≤–∞–µ–º –≥–∞–ª–µ—Ä–µ—é
            modalImage.onclick = function () {
                openCurrentCarGallery(0);
            };
            // ------------------------------

            const techSpecsList = document.getElementById('techSpecs');
            techSpecsList.innerHTML = '';
            if (car.techSpecs && car.techSpecs.length > 0) {
                car.techSpecs.forEach(spec => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span class="spec-name">${spec.name || spec}</span><span class="spec-value">${spec.value || ''}</span>`;
                    techSpecsList.appendChild(li);
                });
            } else {
                techSpecsList.innerHTML = '<li>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</li>';
            }

            const equipmentList = document.getElementById('equipmentSpecs');
            equipmentList.innerHTML = '';
            if (car.equipment && car.equipment.length > 0) {
                car.equipment.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<span class="spec-name">${item.name || item}</span><span class="spec-value">${item.value || ''}</span>`;
                    equipmentList.appendChild(li);
                });
            } else {
                equipmentList.innerHTML = '<li>–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è –Ω–µ —É–∫–∞–∑–∞–Ω–∞</li>';
            }

            const featuresGrid = document.getElementById('featuresGrid');
            featuresGrid.innerHTML = '';
            if (car.features && car.features.length > 0) {
                car.features.forEach(feature => {
                    const div = document.createElement('div');
                    div.className = 'feature-item';
                    div.textContent = feature;
                    featuresGrid.appendChild(div);
                });
            } else {
                featuresGrid.innerHTML = '<div class="feature-item">–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã</div>';
            }

            carModal.style.display = 'block';
        } catch (error) {
            console.error('Error loading car details:', error);
            alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª—è: ${error.message}`);
        }
    }

    closeBtn.addEventListener('click', function() {
        carModal.style.display = 'none';
    });

    window.addEventListener('click', function(event) {
        if (event.target === carModal) {
            carModal.style.display = 'none';
        }
    });

    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            carModal.style.display = 'none';
        }
    });

    // ------------- –ó–ê–ì–†–£–ó–ö–ê –ê–í–¢–û –° –ë–ï–ö–ï–ù–î–ê -------------

    async function loadCars() {
    try {
        const response = await fetch(`${API_BASE}/api/cars`);
        if (!response.ok) {
            throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π: ' + response.status);
        }

        const carsData = await response.json();

        const sectionMap = {
            '–õ–µ–≥–∫–æ–≤—ã–µ': document.querySelector('#light-cars .cards-grid'),
            '–ö—Ä–æ—Å—Å–æ–≤–µ—Ä—ã': document.querySelector('#crossovers .cards-grid'),
            '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ': document.querySelector('#commercial .cards-grid'),
            '–≠–ª–µ–∫—Ç—Ä–æ–º–æ–±–∏–ª–∏': document.querySelector('#electro .cards-grid'),
            '–ì–∏–±—Ä–∏–¥—ã': document.querySelector('#electro .cards-grid')
        };

        carsData.forEach(car => {
            const container = sectionMap[car.category];
            if (!container) return;

            const card = document.createElement('div');
            card.className = 'card';
            card.dataset.searchIndex = JSON.stringify({
                title: car.title,
                description: car.description,
                features: car.features,
                price: `–æ—Ç ${formatPrice(car.price)}`,
                category: car.category,
                image: car.image,
                id: car.id
            });

            card.innerHTML = `
                <img class="card-image" src="${car.image}" alt="${car.title}">
                <div class="card-content">
                    <h3 class="card-title">${car.title}</h3>
                    <p class="card-description">${car.description}</p>
                    <ul class="card-features">
                        ${car.features.map(f => `<li>${f}</li>`).join('')}
                    </ul>
                    <div class="card-price">–æ—Ç ${formatPrice(car.price)}</div>
                    <button class="card-button" onclick="showCarDetails('${car.id}')">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</button>
                    <button class="cart-btn"
                        data-id="${car.id}"
                        data-title="${car.title}"
                        data-price="${car.price}"
                        data-image="${car.image}">
                        <span class="cart-icon">üõí</span> –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
                    </button>
                </div>
            `;

            container.appendChild(card);
        });

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ä—Ç–æ—á–µ–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞
        cards = Array.from(document.querySelectorAll('.card'));
        totalCountEl.textContent = cards.length;

        initSearch();
        initCategoryFromUrl(); // –≤–æ—Ç —ç—Ç–∞ —Å—Ç—Ä–æ—á–∫–∞ –≤–∞–∂–Ω–∞
        updateCartButtons();
    } catch (e) {
        console.error('loadCars error:', e);
        alert('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Å —Å–µ—Ä–≤–µ—Ä–∞');
    }
}

    // ------------- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø -------------

    document.addEventListener('DOMContentLoaded', function() {
        initCart();
        loadCars();
    });
</script>

</body>
</html>